<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>NÃ´ng Tráº¡i VIP Pro - Kho HÃ ng</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Lexend:wght@300;400;600;800;900&display=swap');
        body { margin: 0; padding: 0; overflow: hidden; font-family: 'Lexend', sans-serif; background: #f8fafc; user-select: none; touch-action: manipulation; }
        .bg-header { position: absolute; top: 0; left: 0; width: 100%; height: 160px; background: linear-gradient(135deg, #0f766e, #064e3b); border-radius: 0 0 40px 40px; z-index: 0; }
        .glass-panel { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.5); box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05); }
        .scroll-area { position: absolute; top: 130px; bottom: 85px; left: 0; width: 100%; overflow-y: auto; padding: 0 16px; z-index: 10; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .item-card { animation: slideUp 0.3s ease-out; }
        @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        .nav-bar { position: fixed; bottom: 0; width: 100%; height: 75px; background: white; display: flex; justify-content: space-between; align-items: center; z-index: 150; box-shadow: 0 -5px 25px rgba(0,0,0,0.05); padding-bottom: env(safe-area-inset-bottom); border-radius: 24px 24px 0 0; }
        .nav-item { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; text-decoration: none; color: #9ca3af; transition: all 0.2s; padding-top: 5px; }
        .nav-center-wrap { position: relative; flex: 1.2; display: flex; justify-content: center; }
        .nav-center-btn { position: absolute; top: -30px; width: 65px; height: 65px; background: linear-gradient(135deg, #10b981, #047857); border: 5px solid #f8fafc; border-radius: 50%; display: flex; align-items: center; justify-content: center; box-shadow: 0 8px 20px rgba(16, 185, 129, 0.2); }
        #loading-screen { position: fixed; inset: 0; background: #064e3b; z-index: 9999; display: flex; flex-direction: column; align-items: center; justify-content: center; color: white; transition: opacity 0.3s; }
    </style>
</head>
<body>

<div id="loading-screen">
    <div class="text-6xl animate-pulse mb-3">ğŸ“¦</div>
    <h2 class="text-xl font-black mb-1 tracking-widest text-emerald-300">ÄANG KIá»‚M KHO...</h2>
</div>

<div id="game-container" class="relative w-screen h-screen opacity-0 transition-opacity duration-500">
    <div class="bg-header"></div>
    <div class="absolute top-6 left-0 w-full px-6 flex justify-between items-center z-50">
        <h1 class="text-white text-2xl font-black tracking-tight">Kho NÃ´ng Sáº£n</h1>
        <div class="glass-panel px-4 py-2 rounded-2xl flex items-center gap-2 border-emerald-100/50">
            <span class="text-xl">ğŸ’°</span>
            <span id="gold-val" class="font-black text-orange-600 text-lg">---</span>
        </div>
    </div>

    <div class="scroll-area no-scrollbar" id="inventory-list">
        <!-- Render bá»Ÿi JS -->
    </div>

    <div class="nav-bar">
        <a href="shop.html" class="nav-item"><span class="text-2xl mb-1 grayscale opacity-60">ğŸ›ï¸</span><span class="text-[9px] font-black uppercase tracking-wide">Cá»­a hÃ ng</span></a>
        <a href="kho.html" class="nav-item text-emerald-600"><span class="text-2xl mb-1">ğŸ“¦</span><span class="text-[9px] font-black uppercase tracking-wide">Kho</span></a>
        <a href="trangchu.html" class="nav-center-wrap"><div class="nav-center-btn"><span class="text-3xl pb-1 opacity-80">ğŸŒ±</span></div><span class="text-[10px] font-black uppercase mt-12 tracking-wider text-stone-400">Äáº§u tÆ°</span></a>
        <a href="gt.html" class="nav-item"><span class="text-2xl mb-1 grayscale opacity-60">ğŸ®</span><span class="text-[9px] font-black uppercase tracking-wide">Giáº£i trÃ­</span></a>
        <a href="tk.html" class="nav-item"><span class="text-2xl mb-1 grayscale opacity-60">ğŸ‘¤</span><span class="text-[9px] font-black uppercase tracking-wide">TÃ i khoáº£n</span></a>
    </div>
</div>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
    import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
    import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyAQa6awFxFTOrRXPnda8rS6vlKLKPDMJT0",
      authDomain: "nongtraiheocon.firebaseapp.com",
      projectId: "nongtraiheocon",
      storageBucket: "nongtraiheocon.firebasestorage.app",
      messagingSenderId: "964519162656",
      appId: "1:964519162656:web:27247ed6287dfc74ef5d45",
      measurementId: "G-RT8HPTJERF"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    const ITEMS_INFO = {
        carrot: { name: 'CÃ  rá»‘t', icon: 'ğŸ¥•', bg: 'bg-orange-100', unit: 'ThÃ¹ng' },
        cow: { name: 'Sá»¯a tÆ°Æ¡i', icon: 'ğŸ¥›', bg: 'bg-sky-100', unit: 'ThÃ¹ng' },
        chicken: { name: 'Trá»©ng gÃ ', icon: 'ğŸ¥š', bg: 'bg-yellow-100', unit: 'Vá»‰' },
        sheep: { name: 'BÃ´ng váº£i', icon: 'â˜ï¸', bg: 'bg-slate-100', unit: 'Kg' }
    };

    onAuthStateChanged(auth, async (user) => {
        if (user) {
            const snap = await getDoc(doc(db, "users", user.uid));
            if (snap.exists()) {
                const data = snap.data();
                document.getElementById('gold-val').innerText = (data.gold || 0).toLocaleString();
                renderInventory(data.inventory || {});
            }
            document.getElementById('loading-screen').style.display = 'none';
            document.getElementById('game-container').style.opacity = '1';
        } else { window.location.href = 'index.html'; }
    });

    function renderInventory(inv) {
        const container = document.getElementById('inventory-list');
        const items = Object.entries(inv).filter(([_, qty]) => qty > 0);
        
        if (items.length === 0) {
            container.innerHTML = `<div class="flex flex-col items-center justify-center py-32 opacity-30"><span class="text-7xl mb-4">ğŸ•¸ï¸</span><p class="font-black text-stone-600 uppercase tracking-widest text-sm text-center px-10">Kho trá»‘ng rá»—ng.<br>HÃ£y thu hoáº¡ch á»Ÿ Trang tráº¡i!</p></div>`;
            return;
        }

        const grid = document.createElement('div');
        grid.className = "grid grid-cols-2 gap-4 pb-12";
        items.forEach(([id, qty]) => {
            const info = ITEMS_INFO[id] || { name: id, icon: 'ğŸ“¦', bg: 'bg-stone-100', unit: 'Ä‘v' };
            const card = document.createElement('div');
            card.className = "glass-panel p-5 rounded-[2.5rem] flex flex-col items-center text-center item-card";
            card.innerHTML = `
                <div class="w-20 h-20 ${info.bg} rounded-3xl flex items-center justify-center text-4xl mb-3 shadow-inner border border-white/50">${info.icon}</div>
                <h3 class="font-black text-stone-800 text-sm leading-tight mb-1">${info.name}</h3>
                <div class="bg-emerald-100 text-emerald-700 px-4 py-1 rounded-full text-xs font-black uppercase tracking-tighter">
                    ${qty.toLocaleString()} ${info.unit}
                </div>
            `;
            grid.appendChild(card);
        });
        container.appendChild(grid);
    }
</script>
</body>
</html>

